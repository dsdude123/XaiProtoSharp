# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

XaiProtoSharp is an autogenerated C# library providing a .NET wrapper for xAI's gRPC API. C# code is generated from Protocol Buffer definitions (xai-org/xai-proto) using the Buf CLI.

## Build & Test Commands

```bash
# Build the solution
dotnet build XaiProtoSharp.slnx

# Run all tests (requires XAI_API_KEY env var)
dotnet test Xai.Protos.Test

# Run a single test
dotnet test Xai.Protos.Test --filter "FullyQualifiedName~TestChat"

# Regenerate protobuf/gRPC C# code (requires Buf CLI installed)
buf generate buf.build/xai/proto
```

## Architecture

- **Xai.Protos** — Library project containing only auto-generated C# code from protobuf definitions. No hand-written source files. Multi-targets .NET 8.0, 9.0, and 10.0. Uses dynamic versioning based on UTC date (`yyyy.M.d`).
- **Xai.Protos.Test** — xUnit test project targeting .NET 10.0. Contains integration tests that call the live xAI API (Chat, Image, Video endpoints). Tests require the `XAI_API_KEY` environment variable set with a valid API key.

## Code Generation

`buf.gen.yaml` configures Buf to generate both protobuf message classes and gRPC service clients into the `Xai.Protos/` directory. Generated code uses the `XaiApi` namespace. The `clean: true` setting removes old generated files before regeneration.

## Key Dependencies

- `Google.Protobuf` — Protocol Buffers runtime
- `Grpc.Net.Client` — gRPC client (HTTP/2)
- `Google.Api.Gax.Grpc` — Google API extensions for gRPC

## Authentication Pattern

Tests authenticate with xAI API using bearer token authentication via gRPC metadata headers, reading from the `XAI_API_KEY` environment variable.
